<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
        .done {
            text-decoration: line-through;
        }
    </style>
</head>

<body>
<div>
    1)Не забыть изменить строку в файле config/environments/production.ru :
    #config.action_mailer.default_url_options = { :host => 'yourapp.heroku.com' }
    подробнее на:
    http://stackoverflow.com/questions/4114835/heroku-devise-missing-host-to-link-to-please-provide-host-parameter-or-set-d
</div>
<div>
    2)Научить девайс давать пароли по уже созданным имейлам
</div>
<div class='done'>
    3) Лайтбокс на new беседы
</div>
<div class='done'>
    4) Сделать navbar
</div>
<div class='done'>
    5) валидация на беседу: должна кому-то принадлежать!
</div>
<div class='done'>
    5.1) Открывший беседу не считается
</div>

<div>
    6) доделать сообщения девайса подобно registration edit, кнопки и прочие бутсрап
</div>
<div class="done">
    7) подтверждение регистрации по email
</div>
<div class='done'>
    8) в chosen-rails изменить placeholder и no_result_text
</div>
<div>
   9) при написании create для чата не забыть о валидации и алертах на вьюху
</div>
<div>
    10) сменить адреса файе для продакшена
</div>
<div class="done">
    11) убрать часть подгрузок из лейаута, а то слишком долго загружается страница
</div>
<div>
    12) кеширование в ChatsController#details
</div>
<div class="done">
    13) Валидации: User.name, Chat.subject
</div>
<div>
    14) Сделать уаление: обязательно сделать что-то типа депендент дестрой
        Можно начать с того что если кто то удаляет чат то удаляются и сообщения из него
        Или не делать реального удаления, а помечать как удален (м.б. использольвать гем)
</div>
<div>
    15) Сделать поиск в chosen-rails AJAX - запросами
</div>
<div>
    16) Корявая кнопка "Добавить собеседника"
</div>
<div>
    17) Возможно код по запрету самодобавления в друзьья в UserFriendAssingment не нужен по
    причине того, что код User.find(n).friends << User.find(n) не работает
    Ответ: код нужен, однако сообщение об ошибке в этом коде витает неизвестно где - это
    проблема
</div>
<div>
    18) ВНИМАНИЕ: КОСТЫЛЬ!!!!!11111
    <br>
    Так как плейсхолдеры chosen можно переопределить на вьюхе, остается только одна надпись без
    локализации: 'No results match' - в случае отсутсвия результатов поиска chosen.
    В связи с этим было добавлено:
    <br>
    - В файл app/views/layouts/application.html.haml в самое начало тега body
    скрытая текущая локаль
    <br>
    - В файл app/assets/javascripts/chosen.js.coffee в начале файла по этой текущей локали
    определяется no_results_text (русский или английский)
    <br>
    Как только возникнет необходимость перевести, что либо еще, что НЕ было специально для эттго
    положено на вьюху (т.е. все непреднаменренные переводы на вьюхах не считаются)
    надо создать TranslationController, к которому обратьщаться ajax-запросами и исправить
    этот костыль!
</div>
<div class='done'>
    19) БАГ: в скписке собеседников в правой части таблицы выдаються все беседы собеседника
    этой строки, нужно же только общие к курретн юзером
</div>
<div>
    20) Неадекватное поведение chosen в систуации, когда соответстующий селект реквайрид,
    незаполнен при сабмите
        - в chrome просто вызывается ошибка вида
    An invalid form control with name='user_friend_assignment[friend_id]' is not focusable.
        - в firefox благодаря html5 в левом нижнем углу высовывается кусок сообщения о том что
    селект реквайрид а сам селект дисплей нон
    Должно быть работать без консольных ошибок, чузен должен как и все другие реквайрид поля
    незаполненные при сабмите быть в красной рамке (бутстрап стайл) и иметь большую
    бутстраповскую плашку "Заполните это поле"
</div>
<div>
    21) ОБЯЗАТЕЛЬНО: сделать ограничение на количество запросов нового сообщения с одной и
    той же страницы чата в час
</div>
<div>
    22) Написать МессаджРаспределятор - распределяет полученные сообщения по чатам. Можно взять за
    основу алгоритм: поместить полученное сообщение с ящика А в чат, владельцем которого является
    куррент юзер и в котором он написал сообщение на ящик А позднее всего
</div>
<div>
    23) Написать код заместо заглушки can_send_messages_to? в модели User. Написать также какое
    форнтендовское оповещение отправителю, что это сообщение до такого-то юзера не дошло ибо
    он запретил куррент юзеру посылать сообщения ему.
</div>
<div>
    24) Отказаться от мандрилла. Написать SMTP сервер, воспользовавшись:
        - библиотекой NET/SMTP
        - примерами из файла lib/tasks/net_smtp_exaple.rb, при этом для начала надо заставить
    работать этот пример на локалхосте командой ruby lib/tasks/net_smtp_exaple.rb,
    а после перенести в проект и использовать на удаленном ip адресе (узнать статический ip адрес
    хероку сервера или хероку прокси сервера)
    Ссылки:
    http://stackoverflow.com/questions/10985402/send-email-via-ruby-code-on-heroku
    https://www.google.ru/search?q=how+to+write+smtp+server&oq=how+to+write+smt&aqs=chrome.1.69i57j0l3.12071j0j1&sourceid=chrome&ie=UTF-8#newwindow=1&q=how+to+write+smtp+server+heroku
    http://www.tutorialspoint.com/ruby/ruby_sending_email.htm
    http://www.ruby-doc.org/stdlib-2.1.0/libdoc/net/smtp/rdoc/Net/SMTP.html
</div>
<div>
    25) ОШИБКА(некритичная, на фронтэнде): если юзер А создал чат и отпраил сообщение
    юзерам Б и В то js не покажет это сообщение пока оно не будет получено ИЛИ:
    положим юзер Б ждет это сообщение, заходит в чат и видит его из базы хотя оно еще не получено
    (например из-за задержек на почтовом сервере); когда же Б получит это сообщение, js добавит его
    в чат (но не в базу) и таким образом на фронтэнде будет 2 одинаковых сообщения идущих не
    обязательно друг за другом до обновления страницы.
    Если решать проблему добавлением поля state в таблицу messages, и при отправке вешать на него
    "not_received", а при получении - "received", то при получении сообщения
    юзером Б будет считаться что оно также получено юзером В - это надо учитывать.
</div>
<div>
    26) В списке собеседников сместить селектор бесед чуть ниже, а надпись "Перейти к выбранной
    беседе" поместить НАД ним, убрать эту убогую рамку вокруг нее.
    Также добавить туда ссылку "Создать" по нажатию на которую откроется
    модальное окно с УЖЕ выбранным собеседником и возможность выбрать еще для создание беседы.
    Также добавить селектор "Добавить в беседу" в котором будут беседы созданные куррент юзером.
</div>
<div>
    27) При написании более развитой инфраструктуры спеков ДОБАВИТЬ ФАКТОРИ ГЁРЛ
</div>
<div>
    28) ВАЖНО!! В сценарии "Юзер А создает юзера Б, после чего..." заполнить шаги:
    Юзер А создает юзера Б, после чего
        К этому есть наметка в auth_steps.rb но это работает только в пределах шага, а нужно
        в пределах ВСЕГО сценария. Из-за этого сценарий валится. Чтобы сценарий не валился надо
        закоментировать строку
            before_filter :set_account_password, if: :account_password_not_given?
        в ApplicationController
    И юзеру2 не ушел емейл с подтверждением
    И юзеру2 ушел емейл с подтверждением
        Эти два скорее всего отображатются в один шаг со стабом, но неизв. какой
</div>
<div>
    29) ВЫСШИЙ ПРИОРИТЕТ!!!!!! Написать Message Analizator. Мы можем узнать дату обновления месячной
    квоты. Значит если ежемесячно в этот день записывать общее количество сообщений за ВСЕ ВРЕМЯ 
    (которое можно получить запросом из примера в tasks) (all_time) то количество сообщений в текущем 
    месяце на текущий момент кол-во за все время на тек. момент минус кол-во на начало месяца.
    Возможно придется завести таблицу БД для кол-ва сообщений на начало каждого месяца.     
</div>
<div>
    30) ОТЮЗЕРОВ: сделать возможным редактирование созданного друга, пока он не зарегестрировался
</div>
<div>
    31) ОТЮЗЕРОВ: сделать возможность получения списка контактов с почтового ящика в альтернативу
    ручного создания друзей по одному
</div>
<div>
    32) Отказаться от chosen-rails , перейти на select2-rails и select2-sass-bootstrap-rails.
    Интернационализировать их. Проверить на мобильном эмуляторе.
</div>

</body>
</html>

